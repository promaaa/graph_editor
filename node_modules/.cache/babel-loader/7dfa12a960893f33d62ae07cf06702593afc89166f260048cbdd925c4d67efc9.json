{"ast":null,"code":"var _jsxFileName = \"/Users/promaa/Documents/code/yt-dlp/graph_editor/src/components/ChartPanel.js\",\n  _s = $RefreshSig$();\nimport React, { useRef } from \"react\";\nimport GraphParametersForm from \"./GraphParametersForm\";\nimport GraphPreview from \"./GraphPreview\";\nimport \"./components.css\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst ChartPanel = ({\n  graphParameters,\n  onParametersChange,\n  data,\n  selectedGraphType\n}) => {\n  _s();\n  const chartRef = useRef(null);\n  const handleExport = () => {\n    if (chartRef.current) {\n      const svg = chartRef.current.querySelector(\"svg\");\n      if (svg) {\n        // Add a small delay to ensure styles are applied\n        setTimeout(() => {\n          const svgString = new XMLSerializer().serializeToString(svg);\n          const width = svg.width.baseVal.value;\n          const height = svg.height.baseVal.value;\n          const img = new Image();\n          // Create a blob to handle potential special characters\n          const svgBlob = new Blob([svgString], {\n            type: \"image/svg+xml;charset=utf-8\"\n          });\n          const url = URL.createObjectURL(svgBlob);\n          img.onload = () => {\n            const canvas = document.createElement(\"canvas\");\n            // Set a higher resolution for better quality\n            const scale = 2;\n            canvas.width = width * scale;\n            canvas.height = height * scale;\n            const ctx = canvas.getContext(\"2d\");\n            ctx.scale(scale, scale);\n            ctx.drawImage(img, 0, 0);\n            const pngUrl = canvas.toDataURL(\"image/png\");\n            const link = document.createElement(\"a\");\n            link.href = pngUrl;\n            link.download = `${graphParameters.title || \"chart\"}.png`;\n            document.body.appendChild(link);\n            link.click();\n            document.body.removeChild(link);\n            URL.revokeObjectURL(url);\n          };\n          img.src = url;\n        }, 100);\n      }\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"chart-panel\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"chart-panel-header\",\n      children: [/*#__PURE__*/_jsxDEV(GraphParametersForm, {\n        graphParameters: graphParameters,\n        onParametersChange: onParametersChange\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 61,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: handleExport,\n        className: \"export-btn\",\n        children: \"Export to PNG\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 65,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 60,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(GraphPreview, {\n      ref: chartRef,\n      data: data,\n      graphParameters: graphParameters,\n      selectedGraphType: selectedGraphType\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 69,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 59,\n    columnNumber: 5\n  }, this);\n};\n_s(ChartPanel, \"aW/6lq35noP8VJrK3G9P8gm4OYM=\");\n_c = ChartPanel;\nexport default ChartPanel;\nvar _c;\n$RefreshReg$(_c, \"ChartPanel\");","map":{"version":3,"names":["React","useRef","GraphParametersForm","GraphPreview","jsxDEV","_jsxDEV","ChartPanel","graphParameters","onParametersChange","data","selectedGraphType","_s","chartRef","handleExport","current","svg","querySelector","setTimeout","svgString","XMLSerializer","serializeToString","width","baseVal","value","height","img","Image","svgBlob","Blob","type","url","URL","createObjectURL","onload","canvas","document","createElement","scale","ctx","getContext","drawImage","pngUrl","toDataURL","link","href","download","title","body","appendChild","click","removeChild","revokeObjectURL","src","className","children","fileName","_jsxFileName","lineNumber","columnNumber","onClick","ref","_c","$RefreshReg$"],"sources":["/Users/promaa/Documents/code/yt-dlp/graph_editor/src/components/ChartPanel.js"],"sourcesContent":["import React, { useRef } from \"react\";\nimport GraphParametersForm from \"./GraphParametersForm\";\nimport GraphPreview from \"./GraphPreview\";\nimport \"./components.css\";\n\nconst ChartPanel = ({\n  graphParameters,\n  onParametersChange,\n  data,\n  selectedGraphType,\n}) => {\n  const chartRef = useRef(null);\n\n  const handleExport = () => {\n    if (chartRef.current) {\n      const svg = chartRef.current.querySelector(\"svg\");\n      if (svg) {\n        // Add a small delay to ensure styles are applied\n        setTimeout(() => {\n          const svgString = new XMLSerializer().serializeToString(svg);\n          const width = svg.width.baseVal.value;\n          const height = svg.height.baseVal.value;\n\n          const img = new Image();\n          // Create a blob to handle potential special characters\n          const svgBlob = new Blob([svgString], {\n            type: \"image/svg+xml;charset=utf-8\",\n          });\n          const url = URL.createObjectURL(svgBlob);\n\n          img.onload = () => {\n            const canvas = document.createElement(\"canvas\");\n            // Set a higher resolution for better quality\n            const scale = 2;\n            canvas.width = width * scale;\n            canvas.height = height * scale;\n\n            const ctx = canvas.getContext(\"2d\");\n            ctx.scale(scale, scale);\n            ctx.drawImage(img, 0, 0);\n\n            const pngUrl = canvas.toDataURL(\"image/png\");\n            const link = document.createElement(\"a\");\n            link.href = pngUrl;\n            link.download = `${graphParameters.title || \"chart\"}.png`;\n            document.body.appendChild(link);\n            link.click();\n            document.body.removeChild(link);\n            URL.revokeObjectURL(url);\n          };\n\n          img.src = url;\n        }, 100);\n      }\n    }\n  };\n\n  return (\n    <div className=\"chart-panel\">\n      <div className=\"chart-panel-header\">\n        <GraphParametersForm\n          graphParameters={graphParameters}\n          onParametersChange={onParametersChange}\n        />\n        <button onClick={handleExport} className=\"export-btn\">\n          Export to PNG\n        </button>\n      </div>\n      <GraphPreview\n        ref={chartRef}\n        data={data}\n        graphParameters={graphParameters}\n        selectedGraphType={selectedGraphType}\n      />\n    </div>\n  );\n};\n\nexport default ChartPanel;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}